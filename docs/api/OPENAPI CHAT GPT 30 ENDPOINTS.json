{
    "openapi": "3.1.0",
    "info": {
      "title": "API V2 Abr√®ge - Compl√®te",
      "description": "API V2 moderne et robuste pour la gestion de notes, classeurs, dossiers et agents sp√©cialis√©s avec support LLM. Authentification par cl√© API uniquement.",
      "version": "2.0.0",
      "contact": {
        "name": "Support Abr√®ge",
        "email": "support@scrivia.app",
        "url": "https://docs.scrivia.app"
      },
      "license": {
        "name": "MIT",
        "url": "https://opensource.org/licenses/MIT"
      }
    },
    "servers": [
      {
        "url": "https://www.scrivia.app/api/v2",
        "description": "Production"
      }
    ],
    "security": [
      {
        "ApiKeyAuth": []
      }
    ],
    "paths": {
      "/note/{ref}": {
        "get": {
          "operationId": "getNote",
          "summary": "R√©cup√©rer une note",
          "description": "R√©cup√®re une note par son ID ou slug avec toutes ses m√©tadonn√©es",
          "tags": ["Notes"],
          "security": [{"ApiKeyAuth": []}],
          "parameters": [
            {
              "name": "ref",
              "in": "path",
              "required": true,
              "schema": {"type": "string"},
              "description": "R√©f√©rence de la note (UUID ou slug)"
            }
          ],
          "responses": {
            "200": {
              "description": "Note r√©cup√©r√©e avec succ√®s",
              "content": {
                "application/json": {
                  "schema": {
                    "allOf": [
                      {"$ref": "#/components/schemas/Success"},
                      {
                        "type": "object",
                        "properties": {
                          "data": {"$ref": "#/components/schemas/Note"}
                        }
                      }
                    ]
                  }
                }
              }
            },
            "404": {
              "description": "Note non trouv√©e",
              "content": {
                "application/json": {
                  "schema": {"$ref": "#/components/schemas/Error"}
                }
              }
            }
          }
        }
      },
      "/note/create": {
        "post": {
          "operationId": "createNote",
          "summary": "Cr√©er une nouvelle note",
          "description": "Cr√©er une note dans un classeur. Ne pas inclure de H1 dans le contenu : source_title sert de titre. Utiliser notebook_id (ID ou slug du classeur) et markdown_content pour le corps. folder_id doit √™tre un UUID ou null (pas la cha√Æne \"default\").",
          "tags": ["Notes"],
          "security": [{"ApiKeyAuth": []}],
          "requestBody": {
            "required": true,
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "source_title": {
                      "type": "string",
                      "minLength": 1,
                      "maxLength": 255,
                      "description": "Titre de la note (obligatoire)"
                    },
                    "notebook_id": {
                      "type": "string",
                      "description": "ID ou slug du classeur parent. Optionnel pour brouillons Canva."
                    },
                    "markdown_content": {
                      "type": "string",
                      "default": "",
                      "description": "Contenu markdown (pas de H1 : le titre est source_title)"
                    },
                    "folder_id": {
                      "type": "string",
                      "format": "uuid",
                      "nullable": true,
                      "description": "ID du dossier parent (UUID) ou null pour la racine"
                    },
                    "header_image": {
                      "type": "string",
                      "format": "uri",
                      "description": "URL de l'image d'en-t√™te (optionnel)"
                    },
                    "is_canva_draft": {
                      "type": "boolean",
                      "default": false,
                      "description": "True pour un brouillon Canva (optionnel)"
                    }
                  },
                  "required": ["source_title"]
                }
              }
            }
          },
          "responses": {
            "201": {
              "description": "Note cr√©√©e avec succ√®s",
              "content": {
                "application/json": {
                  "schema": {
                    "allOf": [
                      {"$ref": "#/components/schemas/Success"},
                      {
                        "type": "object",
                        "properties": {
                          "data": {"$ref": "#/components/schemas/Note"}
                        }
                      }
                    ]
                  }
                }
              }
            },
            "422": {
              "description": "Payload invalide (voir details[].field et details[].message)",
              "content": {
                "application/json": {
                  "schema": {"$ref": "#/components/schemas/ValidationError"}
                }
              }
            }
          }
        }
      },
      "/canva/sessions": {
        "post": {
          "operationId": "canva.create_session",
          "summary": "Cr√©er ou ouvrir une session canva",
          "description": "Ouvre une note existante dans le canevas ou cr√©e un nouveau brouillon canva attach√© √† une session de chat.\n\nüìã DEUX MODES (oneOf) - CHOIX BINAIRE :\n\n**Mode 1 - Ouvrir une note existante :**\n- Fournir : `chat_session_id` + `note_id` (OBLIGATOIRE)\n- Utiliser le sch√©ma `OpenCanvaSessionInput`\n- ‚ö†Ô∏è `note_id` ne peut PAS √™tre null/absent dans ce mode\n\n**Mode 2 - Cr√©er un nouveau canvas :**\n- Fournir : `chat_session_id` + `title` (OBLIGATOIRE)\n- NE PAS fournir `note_id` (laisser absent/null)\n- Utiliser le sch√©ma `CreateNewCanvaInput`\n- ‚ö†Ô∏è `title` est dans le tableau `required` de ce sch√©ma\n- ‚ö†Ô∏è `note_id` doit √™tre ABSENT/null pour ce mode\n\nüö® R√àGLE CRITIQUE : \n- Si `note_id` est fourni ‚Üí Mode 1 (ouvrir note existante)\n- Si `note_id` est ABSENT/null ‚Üí Mode 2 (cr√©er nouveau canvas, `title` obligatoire)\n\nüí° Pour cr√©er un nouveau canvas : omettre compl√®tement `note_id` et fournir `title`.",
          "tags": ["Canva"],
          "security": [{"ApiKeyAuth": []}],
          "requestBody": {
            "required": true,
            "content": {
              "application/json": {
                "schema": {
                  "oneOf": [
                    {"$ref": "#/components/schemas/OpenCanvaSessionInput"},
                    {"$ref": "#/components/schemas/CreateNewCanvaInput"}
                  ]
                }
              }
            }
          },
          "responses": {
            "200": {
              "description": "Session canva cr√©√©e avec succ√®s",
              "content": {
                "application/json": {
                  "schema": {
                    "allOf": [
                      {"$ref": "#/components/schemas/Success"},
                      {
                        "type": "object",
                        "properties": {
                          "canva_session": {"$ref": "#/components/schemas/CanvaSession"}
                        }
                      }
                    ]
                  }
                }
              }
            },
            "400": {
              "description": "Payload invalide",
              "content": {
                "application/json": {
                  "schema": {"$ref": "#/components/schemas/Error"}
                }
              }
            },
            "403": {
              "description": "Acc√®s refus√©",
              "content": {
                "application/json": {
                  "schema": {"$ref": "#/components/schemas/Error"}
                }
              }
            }
          }
        },
        "get": {
          "operationId": "canva.list_sessions",
          "summary": "Lister les sessions canva d'une session de chat",
          "description": "Retourne toutes les sessions canva associ√©es √† une session de chat donn√©e. Filtrage par statut via query params.",
          "tags": ["Canva"],
          "security": [{"ApiKeyAuth": []}],
          "parameters": [
            {
              "name": "chat_session_id",
              "in": "query",
              "required": true,
              "schema": {"type": "string", "format": "uuid"},
              "description": "ID de la session de chat"
            },
            {
              "name": "status",
              "in": "query",
              "required": false,
              "schema": {"type": "string"},
              "description": "Filtrer par statut (format: 'open,closed,saved')"
            },
            {
              "name": "include_note",
              "in": "query",
              "required": false,
              "schema": {"type": "boolean", "default": true},
              "description": "Inclure les d√©tails de la note"
            }
          ],
          "responses": {
            "200": {
              "description": "Liste des canvases r√©cup√©r√©e",
              "content": {
                "application/json": {
                  "schema": {
                    "allOf": [
                      {"$ref": "#/components/schemas/Success"},
                      {
                        "type": "object",
                        "properties": {
                          "canva_sessions": {
                            "type": "array",
                            "items": {"$ref": "#/components/schemas/CanvaSession"}
                          },
                          "count": {"type": "integer"}
                        }
                      }
                    ]
                  }
                }
              }
            },
            "400": {
              "description": "Query params invalides",
              "content": {
                "application/json": {
                  "schema": {"$ref": "#/components/schemas/Error"}
                }
              }
            }
          }
        }
      },
      "/canva/sessions/{sessionId}": {
        "get": {
          "operationId": "canva.get_session",
          "summary": "R√©cup√©rer une session canva",
          "description": "Retourne les d√©tails d'une session canva sp√©cifique avec sa note associ√©e.",
          "tags": ["Canva"],
          "security": [{"ApiKeyAuth": []}],
          "parameters": [
            {
              "name": "sessionId",
              "in": "path",
              "required": true,
              "schema": {"type": "string", "format": "uuid"},
              "description": "ID de la canva_session"
            }
          ],
          "responses": {
            "200": {
              "description": "Session canva r√©cup√©r√©e",
              "content": {
                "application/json": {
                  "schema": {
                    "allOf": [
                      {"$ref": "#/components/schemas/Success"},
                      {
                        "type": "object",
                        "properties": {
                          "canva_session": {"$ref": "#/components/schemas/CanvaSession"}
                        }
                      }
                    ]
                  }
                }
              }
            },
            "404": {
              "description": "Session canva introuvable",
              "content": {
                "application/json": {
                  "schema": {"$ref": "#/components/schemas/Error"}
                }
              }
            }
          }
        },
        "patch": {
          "operationId": "canva.update_session",
          "summary": "Mettre √† jour une session canva",
          "description": "Met √† jour le statut ou les m√©tadonn√©es d'une session canva (ex: fermer le pane UI, marquer comme saved).",
          "tags": ["Canva"],
          "security": [{"ApiKeyAuth": []}],
          "parameters": [
            {
              "name": "sessionId",
              "in": "path",
              "required": true,
              "schema": {"type": "string", "format": "uuid"},
              "description": "ID de la canva_session"
            }
          ],
          "requestBody": {
            "required": true,
            "content": {
              "application/json": {
                "schema": {"$ref": "#/components/schemas/UpdateCanvaSessionInput"}
              }
            }
          },
          "responses": {
            "200": {
              "description": "Session canva mise √† jour",
              "content": {
                "application/json": {
                  "schema": {
                    "allOf": [
                      {"$ref": "#/components/schemas/Success"},
                      {
                        "type": "object",
                        "properties": {
                          "canva_session": {"$ref": "#/components/schemas/CanvaSession"}
                        }
                      }
                    ]
                  }
                }
              }
            },
            "400": {
              "description": "Payload invalide",
              "content": {
                "application/json": {
                  "schema": {"$ref": "#/components/schemas/Error"}
                }
              }
            },
            "404": {
              "description": "Session canva introuvable",
              "content": {
                "application/json": {
                  "schema": {"$ref": "#/components/schemas/Error"}
                }
              }
            }
          }
        },
        "delete": {
          "operationId": "canva.delete_session",
          "summary": "Supprimer une session canva",
          "description": "D√©tache d√©finitivement le canva de la conversation (supprime l'entr√©e canva_sessions). Si la note est un brouillon canva, elle sera aussi supprim√©e.",
          "tags": ["Canva"],
          "security": [{"ApiKeyAuth": []}],
          "parameters": [
            {
              "name": "sessionId",
              "in": "path",
              "required": true,
              "schema": {"type": "string", "format": "uuid"},
              "description": "ID de la canva_session √† supprimer"
            }
          ],
          "responses": {
            "200": {
              "description": "Session canva supprim√©e",
              "content": {
                "application/json": {
                  "schema": {
                    "allOf": [
                      {"$ref": "#/components/schemas/Success"},
                      {
                        "type": "object",
                        "properties": {
                          "deleted_session_id": {"type": "string", "format": "uuid"}
                        }
                      }
                    ]
                  }
                }
              }
            },
            "404": {
              "description": "Session canva introuvable",
              "content": {
                "application/json": {
                  "schema": {"$ref": "#/components/schemas/Error"}
                }
              }
            }
          }
        }
      },
      "/canvas/{ref}/ops:stream": {
        "post": {
          "operationId": "canvasStreamOps",
          "summary": "Envoi d'op√©rations streaming canvas",
          "description": "Envoie 1-3 op√©rations atomiques pour l'√©dition collaborative du canvas en temps r√©el. Le serveur valide, applique en m√©moire et retourne un accus√© technique (202 Accepted). Les r√©sultats m√©tier (ACK/CONFLICT) sont √©mis via SSE pour tous les clients.\n\n‚ö†Ô∏è IMPORTANT : Le POST retourne uniquement un accus√© technique. Les r√©sultats m√©tier arrivent via SSE (endpoint `/canvas/{ref}/ops:listen`).\n\nUtilis√© par :\n- Humains (√©diteur canvas UI)\n- LLM (agents d'√©criture, aucun privil√®ge sp√©cial)",
          "tags": ["Canva"],
          "security": [{"ApiKeyAuth": []}],
          "parameters": [
            {
              "name": "ref",
              "in": "path",
              "required": true,
              "schema": {"type": "string"},
              "description": "R√©f√©rence de la note (UUID ou slug)"
            }
          ],
          "requestBody": {
            "required": true,
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "ops": {
                      "type": "array",
                      "minItems": 1,
                      "maxItems": 3,
                      "items": {
                        "type": "object",
                        "properties": {
                          "op_id": {
                            "type": "string",
                            "format": "uuid",
                            "description": "ID unique de l'op√©ration (pour idempotence)"
                          },
                          "client_version": {
                            "type": "string",
                            "description": "ETag connu du client (ex: W/\"etag123\")"
                          },
                          "timestamp": {
                            "type": "integer",
                            "description": "Timestamp de cr√©ation de l'op√©ration (millisecondes)"
                          },
                          "id": {
                            "type": "string",
                            "description": "ID de l'op√©ration (r√©f√©rence interne)"
                          },
                          "action": {
                            "type": "string",
                            "enum": ["insert", "replace", "delete", "upsert_section"],
                            "description": "Type d'op√©ration √† effectuer"
                          },
                          "target": {
                            "type": "object",
                            "properties": {
                              "type": {
                                "type": "string",
                                "enum": ["heading", "regex", "position", "anchor"],
                                "description": "Type de cible"
                              },
                              "heading": {
                                "type": "object",
                                "properties": {
                                  "path": {
                                    "type": "array",
                                    "items": {"type": "string"},
                                    "description": "Chemin du heading (ex: [\"API\", \"Endpoints\"])"
                                  },
                                  "level": {
                                    "type": "integer",
                                    "minimum": 1,
                                    "maximum": 6,
                                    "description": "Niveau du heading (1-6)"
                                  },
                                  "heading_id": {
                                    "type": "string",
                                    "description": "ID du heading (slug)"
                                  }
                                }
                              },
                              "regex": {
                                "type": "object",
                                "properties": {
                                  "pattern": {
                                    "type": "string",
                                    "maxLength": 1000,
                                    "description": "Pattern regex"
                                  },
                                  "flags": {
                                    "type": "string",
                                    "maxLength": 10,
                                    "description": "Flags regex (g, i, m, etc.)"
                                  },
                                  "nth": {
                                    "type": "integer",
                                    "description": "Ni√®me correspondance √† cibler"
                                  }
                                },
                                "required": ["pattern"]
                              },
                              "position": {
                                "type": "object",
                                "properties": {
                                  "mode": {
                                    "type": "string",
                                    "enum": ["offset", "start", "end"],
                                    "description": "Mode de position"
                                  },
                                  "offset": {
                                    "type": "integer",
                                    "minimum": 0,
                                    "description": "Offset en caract√®res"
                                  }
                                },
                                "required": ["mode"]
                              },
                              "anchor": {
                                "type": "object",
                                "properties": {
                                  "name": {
                                    "type": "string",
                                    "enum": ["doc_start", "doc_end", "after_toc", "before_first_heading"],
                                    "description": "Nom de l'ancre s√©mantique"
                                  }
                                },
                                "required": ["name"]
                              }
                            },
                            "required": ["type"]
                          },
                          "where": {
                            "type": "string",
                            "enum": ["before", "after", "inside_start", "inside_end", "at", "replace_match"],
                            "description": "Position relative √† la cible"
                          },
                          "content": {
                            "type": "string",
                            "maxLength": 100000,
                            "description": "Contenu √† ins√©rer/remplacer (requis pour insert/replace/upsert_section)"
                          },
                          "options": {
                            "type": "object",
                            "properties": {
                              "ensure_heading": {"type": "boolean"},
                              "surround_with_blank_lines": {
                                "type": "integer",
                                "minimum": 0,
                                "maximum": 3
                              },
                              "dedent": {"type": "boolean"}
                            }
                          }
                        },
                        "required": ["op_id", "client_version", "timestamp", "id", "action", "target", "where"]
                      },
                      "description": "Liste de 1 √† 3 op√©rations √† appliquer"
                    },
                    "canvas_id": {
                      "type": "string",
                      "format": "uuid",
                      "description": "ID de la session canvas (optionnel, si fourni utilise ce canvas au lieu de ref)"
                    }
                  },
                  "required": ["ops"]
                }
              }
            }
          },
          "responses": {
            "202": {
              "description": "Op√©rations accept√©es (accus√© technique). Les r√©sultats m√©tier (ACK/CONFLICT) arrivent via SSE.",
              "content": {
                "application/json": {
                  "schema": {
                    "type": "object",
                    "properties": {
                      "accepted": {
                        "type": "boolean",
                        "example": true
                      },
                      "ops_count": {
                        "type": "integer",
                        "description": "Nombre d'op√©rations accept√©es"
                      },
                      "duration": {
                        "type": "integer",
                        "description": "Dur√©e de traitement en millisecondes"
                      }
                    }
                  }
                }
              }
            },
            "400": {
              "description": "Validation √©chou√©e",
              "content": {
                "application/json": {
                  "schema": {
                    "allOf": [
                      {"$ref": "#/components/schemas/Error"},
                      {
                        "type": "object",
                        "properties": {
                          "details": {
                            "type": "array",
                            "items": {"type": "object"}
                          }
                        }
                      }
                    ]
                  }
                }
              }
            },
            "401": {
              "description": "Non authentifi√©",
              "content": {
                "application/json": {
                  "schema": {"$ref": "#/components/schemas/Error"}
                }
              }
            },
            "404": {
              "description": "Note ou canvas non trouv√©",
              "content": {
                "application/json": {
                  "schema": {"$ref": "#/components/schemas/Error"}
                }
              }
            },
            "500": {
              "description": "Erreur serveur",
              "content": {
                "application/json": {
                  "schema": {"$ref": "#/components/schemas/Error"}
                }
              }
            }
          }
        }
      },
      "/canvas/{ref}/ops:listen": {
        "get": {
          "operationId": "canvasListenOps",
          "summary": "√âcouter les √©v√©nements streaming canvas (SSE)",
          "description": "Endpoint Server-Sent Events (SSE) pour √©couter les √©v√©nements de streaming canvas en temps r√©el.\n\n‚ö†Ô∏è IMPORTANT : Ce canal SSE est la source de v√©rit√© fonctionnelle unique. Tous les r√©sultats m√©tier (ACK/CONFLICT) sont √©mis via ce canal.\n\n√âv√©nements √©mis :\n- `start` : Connexion √©tablie\n- `ack` : Op√©ration accept√©e (appliqu√©e)\n- `conflict` : Conflit de version d√©tect√© (ETag mismatch)\n- `error` : Erreur serveur\n\nUtilis√© par le frontend pour synchroniser l'√©tat local avec le serveur.",
          "tags": ["Canva"],
          "security": [{"ApiKeyAuth": []}],
          "parameters": [
            {
              "name": "ref",
              "in": "path",
              "required": true,
              "schema": {"type": "string"},
              "description": "R√©f√©rence de la note (UUID ou slug)"
            },
            {
              "name": "token",
              "in": "query",
              "required": false,
              "schema": {"type": "string"},
              "description": "JWT token (requis pour EventSource qui ne supporte pas les headers)"
            }
          ],
          "responses": {
            "200": {
              "description": "Stream SSE actif",
              "content": {
                "text/event-stream": {
                  "schema": {
                    "type": "string",
                    "description": "Stream Server-Sent Events",
                    "example": "event: ack\ndata: {\"event\":\"ack\",\"op_id\":\"uuid\",\"status\":\"applied\",\"server_version\":\"W/\\\"etag\\\"\"}\n\n"
                  }
                }
              },
              "headers": {
                "Content-Type": {
                  "schema": {
                    "type": "string",
                    "example": "text/event-stream"
                  },
                  "description": "Type de contenu SSE"
                },
                "Cache-Control": {
                  "schema": {
                    "type": "string",
                    "example": "no-cache, no-transform"
                  },
                  "description": "Pas de cache pour le stream"
                },
                "Connection": {
                  "schema": {
                    "type": "string",
                    "example": "keep-alive"
                  },
                  "description": "Connexion persistante"
                }
              }
            },
            "401": {
              "description": "Non authentifi√©",
              "content": {
                "application/json": {
                  "schema": {"$ref": "#/components/schemas/Error"}
                }
              }
            },
            "404": {
              "description": "Note non trouv√©e",
              "content": {
                "application/json": {
                  "schema": {"$ref": "#/components/schemas/Error"}
                }
              }
            },
            "500": {
              "description": "Erreur serveur",
              "content": {
                "application/json": {
                  "schema": {"$ref": "#/components/schemas/Error"}
                }
              }
            }
          }
        }
      },
      "/note/{ref}/update": {
        "put": {
          "operationId": "updateNote",
          "summary": "Mettre √† jour une note",
          "description": "Met √† jour le contenu et les m√©tadonn√©es d'une note existante",
          "tags": ["Notes"],
          "security": [{"ApiKeyAuth": []}],
          "parameters": [
            {
              "name": "ref",
              "in": "path",
              "required": true,
              "schema": {"type": "string"},
              "description": "R√©f√©rence de la note (UUID ou slug)"
            }
          ],
          "requestBody": {
            "required": true,
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "source_title": {"type": "string", "maxLength": 255},
                    "markdown_content": {"type": "string"},
                    "html_content": {"type": "string"},
                    "header_image": {"type": "string", "format": "uri", "nullable": true},
                    "header_image_offset": {"type": "number", "minimum": 0, "maximum": 100},
                    "header_image_blur": {"type": "integer", "minimum": 0, "maximum": 5},
                    "header_image_overlay": {"type": "integer", "minimum": 0, "maximum": 5},
                    "header_title_in_image": {"type": "boolean"},
                    "wide_mode": {"type": "boolean"},
                    "a4_mode": {"type": "boolean"},
                    "slash_lang": {"type": "string", "enum": ["fr", "en"]},
                    "font_family": {"type": "string"},
                    "folder_id": {"type": "string", "format": "uuid", "nullable": true},
                    "description": {"type": "string", "maxLength": 500}
                  }
                }
              }
            }
          },
          "responses": {
            "200": {
              "description": "Note mise √† jour avec succ√®s",
              "content": {
                "application/json": {
                  "schema": {
                    "allOf": [
                      {"$ref": "#/components/schemas/Success"},
                      {
                        "type": "object",
                        "properties": {
                          "data": {"$ref": "#/components/schemas/Note"}
                        }
                      }
                    ]
                  }
                }
              }
            }
          }
        }
      },
      "/note/{ref}/content:apply": {
        "post": {
          "operationId": "applyContentOperations",
          "summary": "Appliquer des op√©rations de contenu",
          "description": "Applique des op√©rations de contenu sur une note (insert, replace, delete, upsert_section) avec pr√©cision chirurgicale",
          "tags": ["Notes"],
          "security": [{"ApiKeyAuth": []}],
          "parameters": [
            {
              "name": "ref",
              "in": "path",
              "required": true,
              "schema": {"type": "string"},
              "description": "R√©f√©rence de la note (UUID ou slug)"
            }
          ],
          "requestBody": {
            "required": true,
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "ops": {
                      "type": "array",
                      "items": {
                        "type": "object",
                        "properties": {
                          "id": {"type": "string", "description": "ID unique de l'op√©ration"},
                          "action": {
                            "type": "string",
                            "enum": ["insert", "replace", "delete", "upsert_section"],
                            "description": "Type d'op√©ration √† effectuer"
                          },
                          "target": {
                            "type": "object",
                            "properties": {
                              "type": {
                                "type": "string",
                                "enum": ["heading", "regex", "position", "anchor"],
                                "description": "Type de cible"
                              },
                              "heading": {
                                "type": "object",
                                "properties": {
                                  "path": {
                                    "type": "array",
                                    "items": {"type": "string"},
                                    "description": "Chemin du heading (ex: [\"API\", \"Endpoints\"])"
                                  },
                                  "level": {
                                    "type": "integer",
                                    "minimum": 1,
                                    "maximum": 6,
                                    "description": "Niveau du heading (1-6)"
                                  },
                                  "heading_id": {
                                    "type": "string",
                                    "description": "ID du heading (slug)"
                                  }
                                }
                              },
                              "regex": {
                                "type": "object",
                                "properties": {
                                  "pattern": {
                                    "type": "string",
                                    "maxLength": 1000,
                                    "description": "Pattern regex"
                                  },
                                  "flags": {
                                    "type": "string",
                                    "maxLength": 10,
                                    "description": "Flags regex (g, i, m, etc.)"
                                  },
                                  "nth": {
                                    "type": "integer",
                                    "description": "Ni√®me correspondance √† cibler"
                                  }
                                }
                              },
                              "position": {
                                "type": "object",
                                "properties": {
                                  "mode": {
                                    "type": "string",
                                    "enum": ["offset", "start", "end"],
                                    "description": "Mode de position"
                                  },
                                  "offset": {
                                    "type": "integer",
                                    "minimum": 0,
                                    "description": "Offset en caract√®res"
                                  }
                                }
                              },
                              "anchor": {
                                "type": "object",
                                "properties": {
                                  "name": {
                                    "type": "string",
                                    "enum": ["doc_start", "doc_end", "after_toc", "before_first_heading"],
                                    "description": "Nom de l'ancre s√©mantique"
                                  }
                                }
                              }
                            }
                          },
                          "where": {
                            "type": "string",
                            "enum": ["before", "after", "inside_start", "inside_end", "at", "replace_match"],
                            "description": "Position relative √† la cible"
                          },
                          "content": {
                            "type": "string",
                            "maxLength": 100000,
                            "description": "Contenu √† ins√©rer/remplacer"
                          },
                          "options": {
                            "type": "object",
                            "properties": {
                              "ensure_heading": {"type": "boolean"},
                              "surround_with_blank_lines": {
                                "type": "integer",
                                "minimum": 0,
                                "maximum": 3
                              },
                              "dedent": {"type": "boolean"}
                            }
                          }
                        },
                        "required": ["id", "action", "target", "where"]
                      },
                      "minItems": 1,
                      "maxItems": 50
                    },
                    "dry_run": {
                      "type": "boolean",
                      "default": true,
                      "description": "Mode simulation (ne sauvegarde pas)"
                    },
                    "transaction": {
                      "type": "string",
                      "enum": ["all_or_nothing", "best_effort"],
                      "default": "all_or_nothing",
                      "description": "Mode de transaction"
                    },
                    "conflict_strategy": {
                      "type": "string",
                      "enum": ["fail", "skip"],
                      "default": "fail",
                      "description": "Strat√©gie en cas de conflit"
                    },
                    "return": {
                      "type": "string",
                      "enum": ["content", "diff", "none"],
                      "default": "diff",
                      "description": "Type de retour"
                    },
                    "idempotency_key": {
                      "type": "string",
                      "format": "uuid",
                      "description": "Cl√© d'idempotence"
                    }
                  },
                  "required": ["ops"]
                }
              }
            }
          },
          "responses": {
            "200": {
              "description": "Op√©rations appliqu√©es avec succ√®s",
              "content": {
                "application/json": {
                  "schema": {
                    "allOf": [
                      {"$ref": "#/components/schemas/Success"},
                      {
                        "type": "object",
                        "properties": {
                          "data": {
                            "type": "object",
                            "properties": {
                              "note_id": {"type": "string", "format": "uuid"},
                              "ops_results": {
                                "type": "array",
                                "items": {
                                  "type": "object",
                                  "properties": {
                                    "id": {"type": "string"},
                                    "status": {
                                      "type": "string",
                                      "enum": ["applied", "skipped", "failed"]
                                    },
                                    "matches": {"type": "integer"},
                                    "range_before": {
                                      "type": "object",
                                      "properties": {
                                        "start": {"type": "integer"},
                                        "end": {"type": "integer"}
                                      }
                                    },
                                    "range_after": {
                                      "type": "object",
                                      "properties": {
                                        "start": {"type": "integer"},
                                        "end": {"type": "integer"}
                                      }
                                    },
                                    "preview": {"type": "string"},
                                    "error": {"type": "string"}
                                  }
                                }
                              },
                              "etag": {"type": "string"},
                              "diff": {"type": "string"},
                              "content": {"type": "string"}
                            }
                          },
                          "meta": {
                            "type": "object",
                            "properties": {
                              "dry_run": {"type": "boolean"},
                              "char_diff": {
                                "type": "object",
                                "properties": {
                                  "added": {"type": "integer"},
                                  "removed": {"type": "integer"}
                                }
                              },
                              "execution_time": {"type": "integer"}
                            }
                          }
                        }
                      }
                    ]
                  }
                }
              }
            },
            "400": {
              "description": "Erreur de validation ou regex",
              "content": {
                "application/json": {
                  "schema": {
                    "allOf": [
                      {"$ref": "#/components/schemas/Error"},
                      {
                        "type": "object",
                        "properties": {
                          "code": {
                            "type": "string",
                            "enum": ["REGEX_COMPILE_ERROR", "REGEX_TIMEOUT", "INVALID_OPERATION"]
                          }
                        }
                      }
                    ]
                  }
                }
              }
            },
            "404": {
              "description": "Note non trouv√©e",
              "content": {
                "application/json": {
                  "schema": {
                    "allOf": [
                      {"$ref": "#/components/schemas/Error"},
                      {
                        "type": "object",
                        "properties": {
                          "code": {"type": "string", "enum": ["TARGET_NOT_FOUND"]}
                        }
                      }
                    ]
                  }
                }
              }
            },
            "412": {
              "description": "Version obsol√®te (ETag)",
              "content": {
                "application/json": {
                  "schema": {
                    "allOf": [
                      {"$ref": "#/components/schemas/Error"},
                      {
                        "type": "object",
                        "properties": {
                          "code": {"type": "string", "enum": ["PRECONDITION_FAILED"]}
                        }
                      }
                    ]
                  }
                }
              }
            },
            "422": {
              "description": "Erreur de validation des param√®tres",
              "content": {
                "application/json": {
                  "schema": {"$ref": "#/components/schemas/Error"}
                }
              }
            }
          }
        }
      },
      "/agents": {
        "get": {
          "operationId": "listAgents",
          "summary": "Liste des agents",
          "description": "R√©cup√®re la liste des agents sp√©cialis√©s disponibles",
          "tags": ["Agents Sp√©cialis√©s"],
          "security": [{"ApiKeyAuth": []}],
          "responses": {
            "200": {
              "description": "Liste des agents",
              "content": {
                "application/json": {
                  "schema": {
                    "allOf": [
                      {"$ref": "#/components/schemas/Success"},
                      {
                        "type": "object",
                        "properties": {
                          "data": {
                            "type": "array",
                            "items": {"$ref": "#/components/schemas/Agent"}
                          }
                        }
                      }
                    ]
                  }
                }
              }
            }
          }
        },
        "post": {
          "operationId": "createAgent",
          "summary": "Cr√©er un agent",
          "description": "Cr√©e un nouvel agent sp√©cialis√©",
          "tags": ["Agents Sp√©cialis√©s"],
          "security": [{"ApiKeyAuth": []}],
          "requestBody": {
            "required": true,
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "display_name": {
                      "type": "string",
                      "maxLength": 255,
                      "description": "Nom d'affichage de l'agent"
                    },
                    "slug": {
                      "type": "string",
                      "maxLength": 100,
                      "description": "Slug unique de l'agent"
                    },
                    "description": {
                      "type": "string",
                      "maxLength": 1000,
                      "description": "Description de l'agent"
                    },
                    "model": {
                      "type": "string",
                      "enum": [
                        "openai/gpt-oss-20b",
                        "openai/gpt-oss-120b",
                        "meta-llama/llama-4-scout-17b-16e-instruct",
                        "meta-llama/llama-4-maverick-17b-128e-instruct",
                        "kimi-k2-0905"
                      ],
                      "description": "Mod√®le LLM √† utiliser (mod√®les recommand√©s)"
                    },
                    "provider": {
                      "type": "string",
                      "enum": ["groq", "openai", "anthropic"],
                      "default": "groq",
                      "description": "Fournisseur LLM"
                    },
                    "system_instructions": {
                      "type": "string",
                      "description": "Instructions syst√®me pour l'agent"
                    },
                    "is_chat_agent": {
                      "type": "boolean",
                      "default": false,
                      "description": "Agent de chat ou endpoint"
                    },
                    "temperature": {
                      "type": "number",
                      "minimum": 0,
                      "maximum": 2,
                      "default": 0.7,
                      "description": "Temp√©rature de g√©n√©ration"
                    },
                    "max_tokens": {
                      "type": "integer",
                      "minimum": 1,
                      "maximum": 10000,
                      "default": 4000,
                      "description": "Nombre maximum de tokens"
                    },
                    "api_v2_capabilities": {
                      "type": "array",
                      "items": {"type": "string"},
                      "description": "Capacit√©s API V2 de l'agent"
                    },
                    "input_schema": {
                      "type": "object",
                      "description": "Sch√©ma d'entr√©e OpenAPI"
                    },
                    "output_schema": {
                      "type": "object",
                      "description": "Sch√©ma de sortie OpenAPI"
                    }
                  },
                  "required": ["display_name", "slug", "description", "model"]
                }
              }
            }
          },
          "responses": {
            "201": {
              "description": "Agent cr√©√© avec succ√®s",
              "content": {
                "application/json": {
                  "schema": {
                    "allOf": [
                      {"$ref": "#/components/schemas/Success"},
                      {
                        "type": "object",
                        "properties": {
                          "data": {"$ref": "#/components/schemas/Agent"}
                        }
                      }
                    ]
                  }
                }
              }
            },
            "400": {
              "description": "Donn√©es invalides",
              "content": {
                "application/json": {
                  "schema": {"$ref": "#/components/schemas/Error"}
                }
              }
            }
          }
        }
      },
      "/agents/{agentId}": {
        "get": {
          "operationId": "getAgent",
          "summary": "R√©cup√©rer un agent",
          "description": "R√©cup√®re les d√©tails d'un agent sp√©cialis√©",
          "tags": ["Agents Sp√©cialis√©s"],
          "security": [{"ApiKeyAuth": []}],
          "parameters": [
            {
              "name": "agentId",
              "in": "path",
              "required": true,
              "schema": {"type": "string"},
              "description": "ID de l'agent"
            }
          ],
          "responses": {
            "200": {
              "description": "Agent r√©cup√©r√© avec succ√®s",
              "content": {
                "application/json": {
                  "schema": {
                    "allOf": [
                      {"$ref": "#/components/schemas/Success"},
                      {
                        "type": "object",
                        "properties": {
                          "data": {"$ref": "#/components/schemas/Agent"}
                        }
                      }
                    ]
                  }
                }
              }
            }
          }
        },
        "delete": {
          "operationId": "deleteAgent",
          "summary": "Supprimer un agent",
          "description": "Supprime un agent sp√©cialis√©",
          "tags": ["Agents Sp√©cialis√©s"],
          "security": [{"ApiKeyAuth": []}],
          "parameters": [
            {
              "name": "agentId",
              "in": "path",
              "required": true,
              "schema": {"type": "string"},
              "description": "ID de l'agent"
            }
          ],
          "responses": {
            "200": {
              "description": "Agent supprim√© avec succ√®s",
              "content": {
                "application/json": {
                  "schema": {"$ref": "#/components/schemas/Success"}
                }
              }
            }
          }
        },
        "patch": {
          "operationId": "patchAgent",
          "summary": "Mettre √† jour partiellement un agent",
          "description": "Met √† jour partiellement les propri√©t√©s d'un agent sp√©cialis√©",
          "tags": ["Agents Sp√©cialis√©s"],
          "security": [{"ApiKeyAuth": []}],
          "parameters": [
            {
              "name": "agentId",
              "in": "path",
              "required": true,
              "schema": {"type": "string"},
              "description": "ID ou slug de l'agent"
            }
          ],
          "requestBody": {
            "required": true,
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "display_name": {"type": "string", "maxLength": 255},
                    "description": {"type": "string", "maxLength": 1000},
                    "model": {
                      "type": "string",
                      "enum": [
                        "openai/gpt-oss-20b",
                        "openai/gpt-oss-120b",
                        "meta-llama/llama-4-scout-17b-16e-instruct",
                        "meta-llama/llama-4-maverick-17b-128e-instruct",
                        "kimi-k2-0905"
                      ],
                      "description": "Mod√®le LLM √† utiliser (mod√®les recommand√©s)"
                    },
                    "system_instructions": {"type": "string"},
                    "temperature": {"type": "number", "minimum": 0, "maximum": 2},
                    "max_tokens": {"type": "integer", "minimum": 1, "maximum": 10000},
                    "is_active": {"type": "boolean"},
                    "api_v2_capabilities": {
                      "type": "array",
                      "items": {"type": "string"}
                    }
                  }
                }
              }
            }
          },
          "responses": {
            "200": {
              "description": "Agent mis √† jour avec succ√®s",
              "content": {
                "application/json": {
                  "schema": {
                    "allOf": [
                      {"$ref": "#/components/schemas/Success"},
                      {
                        "type": "object",
                        "properties": {
                          "agent": {"$ref": "#/components/schemas/Agent"}
                        }
                      }
                    ]
                  }
                }
              }
            },
            "404": {
              "description": "Agent non trouv√©",
              "content": {
                "application/json": {
                  "schema": {"$ref": "#/components/schemas/Error"}
                }
              }
            }
          }
        }
      },
      "/agents/execute": {
        "post": {
          "operationId": "executeAgent",
          "summary": "Ex√©cuter un agent universel",
          "description": "Endpoint universel pour ex√©cuter n'importe quel agent sp√©cialis√© avec une interface simple",
          "tags": ["Agents Sp√©cialis√©s"],
          "security": [{"ApiKeyAuth": []}],
          "requestBody": {
            "required": true,
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "ref": {
                      "type": "string",
                      "description": "R√©f√©rence de l'agent (ID ou slug)",
                      "example": "johnny"
                    },
                    "input": {
                      "type": "string",
                      "description": "Message d'entr√©e pour l'agent",
                      "example": "Analyse cette note"
                    },
                    "image": {
                      "type": "string",
                      "format": "uri",
                      "description": "URL de l'image √† analyser (support√© par les mod√®les Llama)",
                      "example": "https://example.com/image.jpg"
                    },
                    "options": {
                      "type": "object",
                      "properties": {
                        "temperature": {
                          "type": "number",
                          "minimum": 0,
                          "maximum": 2,
                          "description": "Temp√©rature de g√©n√©ration (0-2)"
                        },
                        "max_tokens": {
                          "type": "integer",
                          "minimum": 1,
                          "maximum": 10000,
                          "description": "Nombre maximum de tokens"
                        },
                        "stream": {
                          "type": "boolean",
                          "description": "Activer le streaming"
                        }
                      }
                    }
                  },
                  "required": ["ref", "input"]
                }
              }
            }
          },
          "responses": {
            "200": {
              "description": "Agent ex√©cut√© avec succ√®s",
              "content": {
                "application/json": {
                  "schema": {
                    "allOf": [
                      {"$ref": "#/components/schemas/Success"},
                      {
                        "type": "object",
                        "properties": {
                          "data": {
                            "type": "object",
                            "properties": {
                              "ref": {"type": "string", "example": "johnny"},
                              "agent_name": {"type": "string", "example": "Johnny Query"},
                              "agent_id": {"type": "string", "format": "uuid"},
                              "response": {"type": "string", "description": "R√©ponse de l'agent"},
                              "execution_time": {"type": "integer", "description": "Temps d'ex√©cution en ms"},
                              "model_used": {"type": "string", "example": "meta-llama/llama-4-scout-17b-16e-instruct"},
                              "provider": {"type": "string", "example": "groq"}
                            }
                          },
                          "meta": {
                            "type": "object",
                            "properties": {
                              "timestamp": {"type": "string", "format": "date-time"},
                              "agent_slug": {"type": "string"},
                              "agent_type": {"type": "string", "enum": ["chat", "endpoint"]},
                              "input_length": {"type": "integer"},
                              "response_length": {"type": "integer"}
                            }
                          }
                        }
                      }
                    ]
                  }
                }
              }
            },
            "400": {
              "description": "Agent inactif ou param√®tres invalides",
              "content": {
                "application/json": {
                  "schema": {
                    "allOf": [
                      {"$ref": "#/components/schemas/Error"},
                      {
                        "type": "object",
                        "properties": {
                          "code": {"type": "string", "enum": ["AGENT_INACTIVE", "INVALID_INPUT"]}
                        }
                      }
                    ]
                  }
                }
              }
            },
            "404": {
              "description": "Agent non trouv√©",
              "content": {
                "application/json": {
                  "schema": {
                    "allOf": [
                      {"$ref": "#/components/schemas/Error"},
                      {
                        "type": "object",
                        "properties": {
                          "code": {"type": "string", "enum": ["AGENT_NOT_FOUND"]}
                        }
                      }
                    ]
                  }
                }
              }
            },
            "422": {
              "description": "Erreur de validation des param√®tres",
              "content": {
                "application/json": {
                  "schema": {"$ref": "#/components/schemas/Error"}
                }
              }
            },
            "500": {
              "description": "Erreur d'ex√©cution de l'agent",
              "content": {
                "application/json": {
                  "schema": {
                    "allOf": [
                      {"$ref": "#/components/schemas/Error"},
                      {
                        "type": "object",
                        "properties": {
                          "code": {"type": "string", "enum": ["EXECUTION_FAILED"]}
                        }
                      }
                    ]
                  }
                }
              }
            }
          }
        }
      },
      "/search": {
        "get": {
          "operationId": "searchContent",
          "summary": "Recherche de contenu",
          "description": "Recherche dans les notes, classeurs et fichiers",
          "tags": ["Recherche"],
          "security": [{"ApiKeyAuth": []}],
          "parameters": [
            {
              "name": "q",
              "in": "query",
              "required": true,
              "schema": {"type": "string"},
              "description": "Terme de recherche"
            },
            {
              "name": "classeur_id",
              "in": "query",
              "schema": {"type": "string"},
              "description": "ID du classeur √† rechercher"
            },
            {
              "name": "type",
              "in": "query",
              "schema": {"type": "string", "enum": ["all", "notes", "classeurs", "files"]},
              "description": "Type de contenu √† rechercher"
            },
            {
              "name": "limit",
              "in": "query",
              "schema": {"type": "integer", "minimum": 1, "maximum": 100, "default": 20},
              "description": "Nombre maximum de r√©sultats"
            }
          ],
          "responses": {
            "200": {
              "description": "R√©sultats de recherche",
              "content": {
                "application/json": {
                  "schema": {
                    "allOf": [
                      {"$ref": "#/components/schemas/Success"},
                      {
                        "type": "object",
                        "properties": {
                          "results": {
                            "type": "array",
                            "items": {
                              "type": "object",
                              "properties": {
                                "id": {"type": "string"},
                                "title": {"type": "string"},
                                "content": {"type": "string"},
                                "type": {"type": "string"},
                                "score": {"type": "number"}
                              }
                            }
                          },
                          "total": {"type": "integer"},
                          "query": {"type": "string"}
                        }
                      }
                    ]
                  }
                }
              }
            }
          }
        }
      },
      "/files/search": {
        "get": {
          "operationId": "searchFiles",
          "summary": "Recherche de fichiers",
          "description": "Recherche sp√©cifiquement dans les fichiers upload√©s",
          "tags": ["Recherche"],
          "security": [{"ApiKeyAuth": []}],
          "parameters": [
            {
              "name": "q",
              "in": "query",
              "required": false,
              "schema": {"type": "string"},
              "description": "Terme de recherche (optionnel)"
            },
            {
              "name": "type",
              "in": "query",
              "schema": {"type": "string"},
              "description": "Type de fichier √† rechercher (pdf, image, csv, etc.)"
            },
            {
              "name": "limit",
              "in": "query",
              "schema": {"type": "integer", "minimum": 1, "maximum": 100, "default": 20},
              "description": "Nombre maximum de r√©sultats"
            }
          ],
          "responses": {
            "200": {
              "description": "R√©sultats de recherche de fichiers",
              "content": {
                "application/json": {
                  "schema": {
                    "allOf": [
                      {"$ref": "#/components/schemas/Success"},
                      {
                        "type": "object",
                        "properties": {
                          "data": {
                            "type": "array",
                            "items": {
                              "type": "object",
                              "properties": {
                                "id": {"type": "string"},
                                "filename": {"type": "string"},
                                "file_type": {"type": "string"},
                                "size": {"type": "integer"},
                                "url": {"type": "string"},
                                "classeur_id": {"type": "string"},
                                "created_at": {"type": "string", "format": "date-time"}
                              }
                            }
                          },
                          "total": {"type": "integer"},
                          "query": {"type": "string"}
                        }
                      }
                    ]
                  }
                }
              }
            }
          }
        }
      },
      "/delete/{resource}/{ref}": {
        "delete": {
          "operationId": "deleteResource",
          "summary": "Suppression unifi√©e",
          "description": "Supprime une ressource (note, dossier, classeur, fichier) de mani√®re unifi√©e",
          "tags": ["Utilitaires"],
          "security": [{"ApiKeyAuth": []}],
          "parameters": [
            {
              "name": "resource",
              "in": "path",
              "required": true,
              "schema": {"type": "string", "enum": ["note", "folder", "classeur", "file"]},
              "description": "Type de ressource √† supprimer"
            },
            {
              "name": "ref",
              "in": "path",
              "required": true,
              "schema": {"type": "string"},
              "description": "R√©f√©rence de la ressource (UUID ou slug)"
            }
          ],
          "responses": {
            "200": {
              "description": "Ressource supprim√©e avec succ√®s",
              "content": {
                "application/json": {
                  "schema": {"$ref": "#/components/schemas/Success"}
                }
              }
            }
          }
        }
      },
      "/me": {
        "get": {
          "operationId": "getUserProfile",
          "summary": "Profil utilisateur",
          "description": "R√©cup√®re les informations du profil utilisateur",
          "tags": ["Utilisateur"],
          "security": [{"ApiKeyAuth": []}],
          "responses": {
            "200": {
              "description": "Profil utilisateur",
              "content": {
                "application/json": {
                  "schema": {
                    "allOf": [
                      {"$ref": "#/components/schemas/Success"},
                      {
                        "type": "object",
                        "properties": {
                          "data": {
                            "type": "object",
                            "properties": {
                              "id": {"type": "string", "format": "uuid"},
                              "email": {"type": "string", "format": "email"},
                              "name": {"type": "string", "nullable": true},
                              "surname": {"type": "string", "nullable": true},
                              "display_name": {"type": "string", "nullable": true},
                              "profile_picture": {"type": "string", "format": "uri", "nullable": true},
                              "bio": {"type": "string", "nullable": true},
                              "timezone": {"type": "string", "default": "UTC"},
                              "language": {"type": "string", "default": "fr"},
                              "settings": {"type": "object", "nullable": true},
                              "created_at": {"type": "string", "format": "date-time"},
                              "updated_at": {"type": "string", "format": "date-time"}
                            }
                          }
                        }
                      }
                    ]
                  }
                }
              }
            }
          }
        }
      },
      "/note/{ref}/insert-content": {
        "post": {
          "operationId": "insertNoteContent",
          "summary": "Ins√©rer du contenu dans une note",
          "description": "Ins√®re du contenu √† une position sp√©cifique dans une note",
          "tags": ["Notes"],
          "security": [{"ApiKeyAuth": []}],
          "parameters": [
            {
              "name": "ref",
              "in": "path",
              "required": true,
              "schema": {"type": "string"},
              "description": "R√©f√©rence de la note (UUID ou slug)"
            }
          ],
          "requestBody": {
            "required": true,
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "content": {"type": "string", "description": "Contenu √† ins√©rer"},
                    "position": {"type": "integer", "description": "Position d'insertion"},
                    "where": {
                      "type": "string",
                      "enum": ["before", "after", "replace"],
                      "default": "after"
                    }
                  },
                  "required": ["content"]
                }
              }
            }
          },
          "responses": {
            "200": {
              "description": "Contenu ins√©r√© avec succ√®s",
              "content": {
                "application/json": {
                  "schema": {
                    "allOf": [
                      {"$ref": "#/components/schemas/Success"},
                      {
                        "type": "object",
                        "properties": {
                          "data": {"$ref": "#/components/schemas/Note"}
                        }
                      }
                    ]
                  }
                }
              }
            }
          }
        }
      },
      "/note/{ref}/table-of-contents": {
        "get": {
          "operationId": "getNoteTOC",
          "summary": "Table des mati√®res d'une note",
          "description": "R√©cup√®re la table des mati√®res structur√©e d'une note",
          "tags": ["Notes"],
          "security": [{"ApiKeyAuth": []}],
          "parameters": [
            {
              "name": "ref",
              "in": "path",
              "required": true,
              "schema": {"type": "string"},
              "description": "R√©f√©rence de la note (UUID ou slug)"
            }
          ],
          "responses": {
            "200": {
              "description": "Table des mati√®res r√©cup√©r√©e",
              "content": {
                "application/json": {
                  "schema": {
                    "allOf": [
                      {"$ref": "#/components/schemas/Success"},
                      {
                        "type": "object",
                        "properties": {
                          "data": {
                            "type": "array",
                            "items": {
                              "type": "object",
                              "properties": {
                                "level": {"type": "integer"},
                                "title": {"type": "string"},
                                "id": {"type": "string"},
                                "position": {"type": "integer"}
                              }
                            }
                          }
                        }
                      }
                    ]
                  }
                }
              }
            }
          }
        }
      },
      "/note/{ref}/share": {
        "get": {
          "operationId": "getNoteShareSettings",
          "summary": "R√©cup√©rer les param√®tres de partage d'une note",
          "description": "R√©cup√®re les param√®tres de partage actuels d'une note",
          "tags": ["Notes"],
          "security": [{"ApiKeyAuth": []}],
          "parameters": [
            {
              "name": "ref",
              "in": "path",
              "required": true,
              "schema": {"type": "string"},
              "description": "R√©f√©rence de la note (UUID ou slug)"
            }
          ],
          "responses": {
            "200": {
              "description": "Param√®tres de partage r√©cup√©r√©s avec succ√®s",
              "content": {
                "application/json": {
                  "schema": {
                    "allOf": [
                      {"$ref": "#/components/schemas/Success"},
                      {
                        "type": "object",
                        "properties": {
                          "share_settings": {
                            "type": "object",
                            "properties": {
                              "visibility": {
                                "type": "string",
                                "enum": ["private", "link-private", "link-public", "limited", "scrivia"]
                              },
                              "invited_users": {
                                "type": "array",
                                "items": {"type": "string"}
                              },
                              "allow_edit": {"type": "boolean"},
                              "allow_comments": {"type": "boolean"},
                              "link_expires": {"type": "string", "format": "date-time"}
                            }
                          },
                          "public_url": {"type": "string", "nullable": true}
                        }
                      }
                    ]
                  }
                }
              }
            },
            "404": {
              "description": "Note non trouv√©e",
              "content": {
                "application/json": {
                  "schema": {"$ref": "#/components/schemas/Error"}
                }
              }
            }
          }
        },
        "patch": {
          "operationId": "updateNoteShareSettings",
          "summary": "Mettre √† jour les param√®tres de partage d'une note",
          "description": "Met √† jour les param√®tres de partage d'une note (visibilit√©, permissions, etc.)",
          "tags": ["Notes"],
          "security": [{"ApiKeyAuth": []}],
          "parameters": [
            {
              "name": "ref",
              "in": "path",
              "required": true,
              "schema": {"type": "string"},
              "description": "R√©f√©rence de la note (UUID ou slug)"
            }
          ],
          "requestBody": {
            "required": true,
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "visibility": {
                      "type": "string",
                      "enum": ["private", "link-private", "link-public", "limited", "scrivia"],
                      "description": "Niveau de visibilit√© de la note"
                    },
                    "invited_users": {
                      "type": "array",
                      "items": {"type": "string"},
                      "description": "Liste des utilisateurs invit√©s"
                    },
                    "allow_edit": {
                      "type": "boolean",
                      "description": "Autoriser l'√©dition par les utilisateurs invit√©s"
                    },
                    "allow_comments": {
                      "type": "boolean",
                      "description": "Autoriser les commentaires"
                    },
                    "link_expires": {
                      "type": "string",
                      "format": "date-time",
                      "description": "Date d'expiration du lien (optionnel)"
                    }
                  }
                }
              }
            }
          },
          "responses": {
            "200": {
              "description": "Param√®tres de partage mis √† jour avec succ√®s",
              "content": {
                "application/json": {
                  "schema": {
                    "allOf": [
                      {"$ref": "#/components/schemas/Success"},
                      {
                        "type": "object",
                        "properties": {
                          "message": {"type": "string"},
                          "share_settings": {
                            "type": "object",
                            "properties": {
                              "visibility": {
                                "type": "string",
                                "enum": ["private", "link-private", "link-public", "limited", "scrivia"]
                              },
                              "invited_users": {
                                "type": "array",
                                "items": {"type": "string"}
                              },
                              "allow_edit": {"type": "boolean"},
                              "allow_comments": {"type": "boolean"},
                              "link_expires": {"type": "string", "format": "date-time"}
                            }
                          },
                          "public_url": {"type": "string", "nullable": true}
                        }
                      }
                    ]
                  }
                }
              }
            },
            "404": {
              "description": "Note non trouv√©e",
              "content": {
                "application/json": {
                  "schema": {"$ref": "#/components/schemas/Error"}
                }
              }
            },
            "422": {
              "description": "Donn√©es invalides",
              "content": {
                "application/json": {
                  "schema": {"$ref": "#/components/schemas/Error"}
                }
              }
            }
          }
        }
      },
      "/note/{ref}/move": {
        "put": {
          "operationId": "moveNote",
          "summary": "D√©placer une note",
          "description": "D√©place une note vers un autre classeur ou dossier",
          "tags": ["Notes"],
          "security": [{"ApiKeyAuth": []}],
          "parameters": [
            {
              "name": "ref",
              "in": "path",
              "required": true,
              "schema": {"type": "string"},
              "description": "R√©f√©rence de la note (UUID ou slug)"
            }
          ],
          "requestBody": {
            "required": true,
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "target_folder_id": {"type": "string", "format": "uuid", "nullable": true},
                    "target_notebook_id": {"type": "string", "format": "uuid"}
                  }
                }
              }
            }
          },
          "responses": {
            "200": {
              "description": "Note d√©plac√©e avec succ√®s",
              "content": {
                "application/json": {
                  "schema": {
                    "allOf": [
                      {"$ref": "#/components/schemas/Success"},
                      {
                        "type": "object",
                        "properties": {
                          "data": {"$ref": "#/components/schemas/Note"}
                        }
                      }
                    ]
                  }
                }
              }
            }
          }
        }
      },
      "/folder/{ref}": {
        "get": {
          "operationId": "getFolder",
          "summary": "R√©cup√©rer un dossier",
          "description": "R√©cup√®re un dossier par son ID ou slug",
          "tags": ["Dossiers"],
          "security": [{"ApiKeyAuth": []}],
          "parameters": [
            {
              "name": "ref",
              "in": "path",
              "required": true,
              "schema": {"type": "string"},
              "description": "R√©f√©rence du dossier (UUID ou slug)"
            }
          ],
          "responses": {
            "200": {
              "description": "Dossier r√©cup√©r√© avec succ√®s",
              "content": {
                "application/json": {
                  "schema": {
                    "allOf": [
                      {"$ref": "#/components/schemas/Success"},
                      {
                        "type": "object",
                        "properties": {
                          "data": {"$ref": "#/components/schemas/Folder"}
                        }
                      }
                    ]
                  }
                }
              }
            }
          }
        }
      },
      "/folder/create": {
        "post": {
          "operationId": "createFolder",
          "summary": "Cr√©er un dossier",
          "description": "Cr√©e un nouveau dossier dans un classeur",
          "tags": ["Dossiers"],
          "security": [{"ApiKeyAuth": []}],
          "requestBody": {
            "required": true,
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "name": {"type": "string", "maxLength": 255},
                    "classeur_id": {"type": "string", "format": "uuid"},
                    "parent_folder_id": {"type": "string", "format": "uuid"},
                    "position": {"type": "integer"}
                  },
                  "required": ["name", "classeur_id"]
                }
              }
            }
          },
          "responses": {
            "201": {
              "description": "Dossier cr√©√© avec succ√®s",
              "content": {
                "application/json": {
                  "schema": {
                    "allOf": [
                      {"$ref": "#/components/schemas/Success"},
                      {
                        "type": "object",
                        "properties": {
                          "data": {"$ref": "#/components/schemas/Folder"}
                        }
                      }
                    ]
                  }
                }
              }
            }
          }
        }
      },
      "/folder/{ref}/update": {
        "put": {
          "operationId": "updateFolder",
          "summary": "Mettre √† jour un dossier",
          "description": "Met √† jour les propri√©t√©s d'un dossier",
          "tags": ["Dossiers"],
          "security": [{"ApiKeyAuth": []}],
          "parameters": [
            {
              "name": "ref",
              "in": "path",
              "required": true,
              "schema": {"type": "string"},
              "description": "R√©f√©rence du dossier (UUID ou slug)"
            }
          ],
          "requestBody": {
            "required": true,
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "name": {"type": "string", "maxLength": 255},
                    "position": {"type": "integer"}
                  }
                }
              }
            }
          },
          "responses": {
            "200": {
              "description": "Dossier mis √† jour avec succ√®s",
              "content": {
                "application/json": {
                  "schema": {
                    "allOf": [
                      {"$ref": "#/components/schemas/Success"},
                      {
                        "type": "object",
                        "properties": {
                          "data": {"$ref": "#/components/schemas/Folder"}
                        }
                      }
                    ]
                  }
                }
              }
            }
          }
        }
      },
      "/folder/{ref}/tree": {
        "get": {
          "operationId": "getFolderTree",
          "summary": "Arbre d'un dossier",
          "description": "R√©cup√®re l'arbre complet d'un dossier avec ses sous-dossiers et notes",
          "tags": ["Dossiers"],
          "security": [{"ApiKeyAuth": []}],
          "parameters": [
            {
              "name": "ref",
              "in": "path",
              "required": true,
              "schema": {"type": "string"},
              "description": "R√©f√©rence du dossier (UUID ou slug)"
            }
          ],
          "responses": {
            "200": {
              "description": "Arbre du dossier r√©cup√©r√©",
              "content": {
                "application/json": {
                  "schema": {
                    "allOf": [
                      {"$ref": "#/components/schemas/Success"},
                      {
                        "type": "object",
                        "properties": {
                          "data": {
                            "type": "object",
                            "properties": {
                              "folder": {"$ref": "#/components/schemas/Folder"},
                              "subfolders": {
                                "type": "array",
                                "items": {"$ref": "#/components/schemas/Folder"}
                              },
                              "notes": {
                                "type": "array",
                                "items": {"$ref": "#/components/schemas/Note"}
                              }
                            }
                          }
                        }
                      }
                    ]
                  }
                }
              }
            }
          }
        }
      },
      "/folder/{ref}/move": {
        "post": {
          "operationId": "moveFolder",
          "summary": "D√©placer un dossier",
          "description": "D√©place un dossier vers un autre classeur ou dossier parent",
          "tags": ["Dossiers"],
          "security": [{"ApiKeyAuth": []}],
          "parameters": [
            {
              "name": "ref",
              "in": "path",
              "required": true,
              "schema": {"type": "string"},
              "description": "R√©f√©rence du dossier (UUID ou slug)"
            }
          ],
          "requestBody": {
            "required": true,
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "classeur_id": {"type": "string", "format": "uuid"},
                    "parent_folder_id": {"type": "string", "format": "uuid"},
                    "position": {"type": "integer"}
                  },
                  "required": ["classeur_id"]
                }
              }
            }
          },
          "responses": {
            "200": {
              "description": "Dossier d√©plac√© avec succ√®s",
              "content": {
                "application/json": {
                  "schema": {
                    "allOf": [
                      {"$ref": "#/components/schemas/Success"},
                      {
                        "type": "object",
                        "properties": {
                          "data": {"$ref": "#/components/schemas/Folder"}
                        }
                      }
                    ]
                  }
                }
              }
            }
          }
        }
      },
      "/classeurs": {
        "get": {
          "operationId": "listClasseurs",
          "summary": "Liste des classeurs",
          "description": "R√©cup√®re la liste des classeurs de l'utilisateur",
          "tags": ["Classeurs"],
          "security": [{"ApiKeyAuth": []}],
          "responses": {
            "200": {
              "description": "Liste des classeurs",
              "content": {
                "application/json": {
                  "schema": {
                    "allOf": [
                      {"$ref": "#/components/schemas/Success"},
                      {
                        "type": "object",
                        "properties": {
                          "data": {
                            "type": "array",
                            "items": {"$ref": "#/components/schemas/Classeur"}
                          }
                        }
                      }
                    ]
                  }
                }
              }
            }
          }
        }
      },
      "/classeur/create": {
        "post": {
          "operationId": "createClasseur",
          "summary": "Cr√©er un classeur",
          "description": "Cr√©e un nouveau classeur pour l'utilisateur",
          "tags": ["Classeurs"],
          "security": [{"ApiKeyAuth": []}],
          "requestBody": {
            "required": true,
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "name": {"type": "string", "maxLength": 255},
                    "description": {"type": "string", "maxLength": 1000},
                    "color": {"type": "string", "pattern": "^#[0-9A-Fa-f]{6}$"},
                    "position": {"type": "integer"}
                  },
                  "required": ["name"]
                }
              }
            }
          },
          "responses": {
            "201": {
              "description": "Classeur cr√©√© avec succ√®s",
              "content": {
                "application/json": {
                  "schema": {
                    "allOf": [
                      {"$ref": "#/components/schemas/Success"},
                      {
                        "type": "object",
                        "properties": {
                          "data": {"$ref": "#/components/schemas/Classeur"}
                        }
                      }
                    ]
                  }
                }
              }
            }
          }
        }
      },
      "/classeur/{ref}": {
        "get": {
          "operationId": "getClasseur",
          "summary": "R√©cup√©rer un classeur",
          "description": "R√©cup√®re un classeur par son ID ou slug",
          "tags": ["Classeurs"],
          "security": [{"ApiKeyAuth": []}],
          "parameters": [
            {
              "name": "ref",
              "in": "path",
              "required": true,
              "schema": {"type": "string"},
              "description": "R√©f√©rence du classeur (UUID ou slug)"
            }
          ],
          "responses": {
            "200": {
              "description": "Classeur r√©cup√©r√© avec succ√®s",
              "content": {
                "application/json": {
                  "schema": {
                    "allOf": [
                      {"$ref": "#/components/schemas/Success"},
                      {
                        "type": "object",
                        "properties": {
                          "data": {"$ref": "#/components/schemas/Classeur"}
                        }
                      }
                    ]
                  }
                }
              }
            }
          }
        }
      },
      "/classeur/{ref}/update": {
        "put": {
          "operationId": "updateClasseur",
          "summary": "Mettre √† jour un classeur",
          "description": "Met √† jour les propri√©t√©s d'un classeur",
          "tags": ["Classeurs"],
          "security": [{"ApiKeyAuth": []}],
          "parameters": [
            {
              "name": "ref",
              "in": "path",
              "required": true,
              "schema": {"type": "string"},
              "description": "R√©f√©rence du classeur (UUID ou slug)"
            }
          ],
          "requestBody": {
            "required": true,
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "name": {"type": "string", "maxLength": 255},
                    "description": {"type": "string", "maxLength": 1000},
                    "color": {"type": "string", "pattern": "^#[0-9A-Fa-f]{6}$"},
                    "position": {"type": "integer"}
                  }
                }
              }
            }
          },
          "responses": {
            "200": {
              "description": "Classeur mis √† jour avec succ√®s",
              "content": {
                "application/json": {
                  "schema": {
                    "allOf": [
                      {"$ref": "#/components/schemas/Success"},
                      {
                        "type": "object",
                        "properties": {
                          "data": {"$ref": "#/components/schemas/Classeur"}
                        }
                      }
                    ]
                  }
                }
              }
            }
          }
        }
      },
      "/classeur/{ref}/tree": {
        "get": {
          "operationId": "getClasseurTree",
          "summary": "Arbre d'un classeur",
          "description": "R√©cup√®re l'arbre complet d'un classeur avec ses dossiers et notes",
          "tags": ["Classeurs"],
          "security": [{"ApiKeyAuth": []}],
          "parameters": [
            {
              "name": "ref",
              "in": "path",
              "required": true,
              "schema": {"type": "string"},
              "description": "R√©f√©rence du classeur (UUID ou slug)"
            }
          ],
          "responses": {
            "200": {
              "description": "Arbre du classeur r√©cup√©r√©",
              "content": {
                "application/json": {
                  "schema": {
                    "allOf": [
                      {"$ref": "#/components/schemas/Success"},
                      {
                        "type": "object",
                        "properties": {
                          "data": {
                            "type": "object",
                            "properties": {
                              "classeur": {"$ref": "#/components/schemas/Classeur"},
                              "folders": {
                                "type": "array",
                                "items": {"$ref": "#/components/schemas/Folder"}
                              },
                              "notes": {
                                "type": "array",
                                "items": {"$ref": "#/components/schemas/Note"}
                              }
                            }
                          }
                        }
                      }
                    ]
                  }
                }
              }
            }
          }
        }
      },
      "/classeur/reorder": {
        "put": {
          "operationId": "reorderClasseurs",
          "summary": "R√©organiser les classeurs",
          "description": "R√©organise l'ordre des classeurs de l'utilisateur",
          "tags": ["Classeurs"],
          "security": [{"ApiKeyAuth": []}],
          "requestBody": {
            "required": true,
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "classeur_orders": {
                      "type": "array",
                      "items": {
                        "type": "object",
                        "properties": {
                          "classeur_id": {"type": "string", "format": "uuid"},
                          "position": {"type": "integer"}
                        },
                        "required": ["classeur_id", "position"]
                      }
                    }
                  },
                  "required": ["classeur_orders"]
                }
              }
            }
          },
          "responses": {
            "200": {
              "description": "Classeurs r√©organis√©s avec succ√®s",
              "content": {
                "application/json": {
                  "schema": {
                    "allOf": [
                      {"$ref": "#/components/schemas/Success"},
                      {
                        "type": "object",
                        "properties": {
                          "data": {
                            "type": "array",
                            "items": {"$ref": "#/components/schemas/Classeur"}
                          }
                        }
                      }
                    ]
                  }
                }
              }
            }
          }
        }
      }
    },
    "components": {
      "securitySchemes": {
        "ApiKeyAuth": {
          "type": "apiKey",
          "in": "header",
          "name": "X-API-Key",
          "description": "Cl√© API d'Abr√®ge"
        }
      },
      "schemas": {
        "Success": {
          "type": "object",
          "properties": {
            "success": {
              "type": "boolean",
              "example": true
            },
            "message": {
              "type": "string",
              "description": "Message de succ√®s optionnel"
            },
            "metadata": {
              "type": "object",
              "properties": {
                "timestamp": {"type": "string", "format": "date-time"},
                "executionTime": {"type": "number"}
              }
            }
          },
          "required": ["success"]
        },
        "Error": {
          "type": "object",
          "properties": {
            "success": {
              "type": "boolean",
              "example": false
            },
            "error": {
              "type": "string",
              "description": "Message d'erreur descriptif"
            },
            "code": {
              "type": "string",
              "description": "Code d'erreur sp√©cifique"
            },
            "details": {
              "type": "array",
              "items": {"type": "string"},
              "description": "D√©tails des erreurs de validation"
            },
            "metadata": {
              "type": "object",
              "properties": {
                "timestamp": {"type": "string", "format": "date-time"},
                "executionTime": {"type": "number"},
                "requestId": {"type": "string"}
              }
            }
          },
          "required": ["success", "error"]
        },
        "ValidationError": {
          "type": "object",
          "description": "R√©ponse 422 : erreur de validation du payload avec d√©tails par champ",
          "properties": {
            "error": { "type": "string", "example": "Payload invalide" },
            "details": {
              "type": "array",
              "items": {
                "type": "object",
                "properties": {
                  "field": { "type": "string" },
                  "message": { "type": "string" }
                },
                "required": ["field", "message"]
              }
            },
            "summary": { "type": "string" }
          },
          "required": ["error", "details"]
        },
        "Note": {
          "type": "object",
          "properties": {
            "id": {
              "type": "string",
              "format": "uuid",
              "description": "ID unique de la note"
            },
            "source_title": {
              "type": "string",
              "maxLength": 255,
              "description": "Titre de la note"
            },
            "slug": {
              "type": "string",
              "description": "Slug unique de la note"
            },
            "content": {
              "type": "string",
              "description": "Contenu markdown de la note"
            },
            "html_content": {
              "type": "string",
              "description": "Contenu HTML g√©n√©r√©"
            },
            "visibility": {
              "type": "string",
              "enum": ["private", "public", "link-private", "link-public"],
              "description": "Visibilit√© de la note"
            },
            "public_url": {
              "type": "string",
              "description": "URL publique de la note"
            },
            "classeur_id": {
              "type": "string",
              "format": "uuid",
              "description": "ID du classeur parent"
            },
            "folder_id": {
              "type": "string",
              "format": "uuid",
              "description": "ID du dossier parent"
            },
            "position": {
              "type": "integer",
              "description": "Position dans le classeur"
            },
            "created_at": {
              "type": "string",
              "format": "date-time",
              "description": "Date de cr√©ation"
            },
            "updated_at": {
              "type": "string",
              "format": "date-time",
              "description": "Date de derni√®re modification"
            },
            "etag": {
              "type": "string",
              "description": "ETag pour la gestion de version"
            }
          },
          "required": ["id", "source_title", "content"]
        },
        "Folder": {
          "type": "object",
          "properties": {
            "id": {
              "type": "string",
              "format": "uuid",
              "description": "ID unique du dossier"
            },
            "name": {
              "type": "string",
              "maxLength": 255,
              "description": "Nom du dossier"
            },
            "slug": {
              "type": "string",
              "description": "Slug unique du dossier"
            },
            "classeur_id": {
              "type": "string",
              "format": "uuid",
              "description": "ID du classeur parent"
            },
            "parent_folder_id": {
              "type": "string",
              "format": "uuid",
              "description": "ID du dossier parent (optionnel)"
            },
            "position": {
              "type": "integer",
              "description": "Position dans le classeur"
            },
            "created_at": {
              "type": "string",
              "format": "date-time",
              "description": "Date de cr√©ation"
            },
            "updated_at": {
              "type": "string",
              "format": "date-time",
              "description": "Date de derni√®re modification"
            }
          },
          "required": ["id", "name", "classeur_id"]
        },
        "Classeur": {
          "type": "object",
          "properties": {
            "id": {
              "type": "string",
              "format": "uuid",
              "description": "ID unique du classeur"
            },
            "name": {
              "type": "string",
              "maxLength": 255,
              "description": "Nom du classeur"
            },
            "slug": {
              "type": "string",
              "description": "Slug unique du classeur"
            },
            "description": {
              "type": "string",
              "maxLength": 1000,
              "description": "Description du classeur"
            },
            "color": {
              "type": "string",
              "pattern": "^#[0-9A-Fa-f]{6}$",
              "description": "Couleur du classeur (hex)"
            },
            "position": {
              "type": "integer",
              "description": "Position dans la liste des classeurs"
            },
            "created_at": {
              "type": "string",
              "format": "date-time",
              "description": "Date de cr√©ation"
            },
            "updated_at": {
              "type": "string",
              "format": "date-time",
              "description": "Date de derni√®re modification"
            }
          },
          "required": ["id", "name"]
        },
        "Agent": {
          "type": "object",
          "properties": {
            "id": {
              "type": "string",
              "format": "uuid",
              "description": "ID unique de l'agent"
            },
            "name": {
              "type": "string",
              "maxLength": 255,
              "description": "Nom de l'agent"
            },
            "slug": {
              "type": "string",
              "description": "Slug unique de l'agent"
            },
            "description": {
              "type": "string",
              "maxLength": 1000,
              "description": "Description de l'agent"
            },
            "model": {
              "type": "string",
              "description": "Mod√®le LLM utilis√© par l'agent"
            },
            "provider": {
              "type": "string",
              "enum": ["groq", "openai", "anthropic"],
              "description": "Fournisseur LLM"
            },
            "input_schema": {
              "type": "object",
              "nullable": true,
              "description": "Sch√©ma d'entr√©e OpenAPI"
            },
            "output_schema": {
              "type": "object",
              "nullable": true,
              "description": "Sch√©ma de sortie OpenAPI"
            },
            "is_active": {
              "type": "boolean",
              "description": "Statut actif de l'agent"
            },
            "is_chat_agent": {
              "type": "boolean",
              "description": "Agent de chat ou endpoint"
            },
            "is_endpoint_agent": {
              "type": "boolean",
              "description": "Agent endpoint ou chat"
            },
            "capabilities": {
              "type": "array",
              "items": {"type": "string"},
              "description": "Capacit√©s de l'agent"
            },
            "api_v2_capabilities": {
              "type": "array",
              "items": {"type": "string"},
              "description": "Capacit√©s API V2 de l'agent"
            },
            "temperature": {
              "type": "number",
              "minimum": 0,
              "maximum": 2,
              "description": "Temp√©rature de g√©n√©ration"
            },
            "max_tokens": {
              "type": "integer",
              "minimum": 1,
              "maximum": 10000,
              "description": "Nombre maximum de tokens"
            },
            "priority": {
              "type": "integer",
              "description": "Priorit√© de l'agent"
            },
            "created_at": {
              "type": "string",
              "format": "date-time",
              "description": "Date de cr√©ation"
            },
            "updated_at": {
              "type": "string",
              "format": "date-time",
              "description": "Date de derni√®re modification"
            },
            "metadata": {
              "type": "object",
              "description": "M√©tadonn√©es de l'agent"
            }
          },
          "required": ["name", "slug", "description", "is_active"]
        },
        "CanvaSession": {
          "type": "object",
          "properties": {
            "id": {"type": "string", "format": "uuid"},
            "chat_session_id": {"type": "string", "format": "uuid"},
            "note_id": {"type": "string", "format": "uuid"},
            "title": {"type": "string"},
            "status": {"type": "string", "enum": ["open", "closed", "saved", "deleted"]},
            "created_at": {"type": "string", "format": "date-time"},
            "closed_at": {"type": "string", "format": "date-time", "nullable": true},
            "saved_at": {"type": "string", "format": "date-time", "nullable": true},
            "metadata": {
              "type": "object",
              "additionalProperties": true,
              "nullable": true
            },
            "note": {"$ref": "#/components/schemas/Note"}
          },
          "required": ["id", "chat_session_id", "note_id", "status", "created_at"]
        },
        "OpenCanvaSessionInput": {
          "type": "object",
          "description": "Mode 1 : Ouvrir une note existante dans le canva. ‚ö†Ô∏è `note_id` est OBLIGATOIRE et ne peut PAS √™tre null/absent.",
          "properties": {
            "chat_session_id": {
              "type": "string",
              "format": "uuid",
              "description": "ID de la session de chat cible"
            },
            "note_id": {
              "type": "string",
              "description": "ID ou slug de la note existante √† ouvrir dans le canva. ‚ö†Ô∏è OBLIGATOIRE : ce param√®tre doit √™tre fourni et ne peut pas √™tre null/absent."
            }
          },
          "required": ["chat_session_id", "note_id"]
        },
        "CreateNewCanvaInput": {
          "type": "object",
          "description": "Mode 2 : Cr√©er un nouveau brouillon canva. ‚ö†Ô∏è ATTENTION : `note_id` doit √™tre ABSENT/null (ne pas le fournir). `title` est OBLIGATOIRE et est dans le tableau required.",
          "properties": {
            "chat_session_id": {
              "type": "string",
              "format": "uuid",
              "description": "ID de la session de chat cible"
            },
            "title": {
              "type": "string",
              "minLength": 1,
              "maxLength": 255,
              "description": "üö® OBLIGATOIRE : Titre du nouveau canvas √† cr√©er. Exemples : \"Mon nouveau canvas\", \"Brainstorming du jour\", \"Travail sur le Canevas\", \"Canevas de travail sur Scrivia\". Ce param√®tre est REQUIS et ne peut JAMAIS √™tre omis. ‚ö†Ô∏è `note_id` doit √™tre ABSENT/null pour utiliser ce mode."
            },
            "classeur_id": {
              "type": "string",
              "description": "ID du classeur cible (optionnel)"
            },
            "initial_content": {
              "type": "string",
              "description": "Contenu initial du brouillon canva (optionnel)"
            }
          },
          "required": ["chat_session_id", "title"]
        },
        "UpdateCanvaSessionInput": {
          "type": "object",
          "properties": {
            "status": {
              "type": "string",
              "enum": ["open", "closed", "saved", "deleted"],
              "description": "Nouveau statut de la session"
            },
            "metadata": {
              "type": "object",
              "additionalProperties": true,
              "description": "M√©tadonn√©es personnalis√©es"
            },
            "reason": {
              "type": "string",
              "enum": ["user_action", "inactivity", "llm_tool"],
              "description": "Raison du changement de statut"
            }
          },
          "description": "Au moins status ou metadata doit √™tre fourni"
        }
      }
    },
    "tags": [
      {
        "name": "Notes",
        "description": "Gestion des notes et contenu"
      },
      {
        "name": "Dossiers",
        "description": "Gestion des dossiers"
      },
      {
        "name": "Classeurs",
        "description": "Gestion des classeurs et organisation"
      },
      {
        "name": "Agents Sp√©cialis√©s",
        "description": "Endpoints pour les agents IA sp√©cialis√©s"
      },
      {
        "name": "Recherche",
        "description": "Recherche et filtrage de contenu"
      },
      {
        "name": "Corbeille",
        "description": "Gestion de la corbeille"
      },
      {
        "name": "Utilisateur",
        "description": "Gestion du profil utilisateur"
      },
      {
        "name": "Utilitaires",
        "description": "Outils et utilitaires"
      },
      {
        "name": "Documentation",
        "description": "Documentation et m√©tadonn√©es de l'API"
      },
      {
        "name": "Canva",
        "description": "Gestion des sessions Canva li√©es au chat"
      }
    ]
  }
  