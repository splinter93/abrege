/* ==========================================================================
   MERMAID THEME - DARK & ELEGANT
   ==========================================================================
   - Thème sombre inspiré de GitHub Dark & Linear
   - Assure la lisibilité et la cohérence avec le container de bloc unifié
*/

/* Variables du thème Mermaid */
:root {
  --mermaid-theme-background: transparent; /* Le fond est géré par .unified-block-container */
  --block-bg: var(--color-bg-content); /* Variable unifiée pour les éléments de contenu */
  --mermaid-theme-text-color: #d1d5db; /* Gris clair pour le texte */
  --mermaid-theme-primary-color: #38bdf8; /* Bleu ciel pour les éléments principaux (ex: boîtes de flowchart) */
  --mermaid-theme-primary-border-color: #0ea5e9;
  --mermaid-theme-primary-text-color: #0c0a09; /* Texte sombre sur fond clair pour contraste */
  --mermaid-theme-secondary-color: #374151; /* Gris sombre pour les éléments secondaires */
  --mermaid-theme-secondary-border-color: #4b5563;
  --mermaid-theme-secondary-text-color: #e5e7eb;
  --mermaid-theme-tertiary-color: #1f2937;
  --mermaid-theme-tertiary-border-color: #374151;
  --mermaid-theme-tertiary-text-color: #d1d5db;
  --mermaid-theme-line-color: #4b5563; /* Couleur des flèches et lignes */
  --mermaid-theme-font-family: 'Figtree', 'Geist', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif; /* ✅ Cohérent avec chat */
  --mermaid-theme-font-size: 18px; /* ✅ Augmenté pour lisibilité */
}

/* Application du thème via le renderer Mermaid */
/* Le `init` de Mermaid dans le composant doit spécifier `theme: 'base'`
   et `themeVariables` avec les valeurs ci-dessus.
   Ce fichier CSS sert de fallback et pour styler des éléments
   que les variables de thème ne peuvent pas atteindre.
*/

/* Styles globaux pour tous les SVGs Mermaid */
.mermaid-svg-container svg {
  font-family: var(--mermaid-theme-font-family) ;
  font-size: var(--mermaid-theme-font-size) ;
  color: var(--mermaid-theme-text-color);
  background: transparent !important;
  border-radius: 12px;
}

/* ✅ Centrage global du texte SVG + taille cohérente */
.mermaid-svg-container svg text {
  text-anchor: middle !important;
  dominant-baseline: central !important;
  font-family: var(--font-chat-text) !important; /* ✅ Cohérent avec chat */
  font-size: 18px !important; /* ✅ Taille augmentée pour lisibilité */
}

/* ✅ Font-size spécifique pour le texte dans les nodes */
.mermaid-svg-container .nodeLabel,
.mermaid-svg-container .node text tspan {
  font-size: 18px !important;
}

/* Texte dans les noeuds - centrage */
.mermaid-svg-container .nodeLabel {
  color: #ffffff !important;
  display: flex !important;
  align-items: center !important;
  justify-content: center !important;
  text-align: center !important;
}

.mermaid-svg-container .node text {
  fill: #ffffff !important;
  text-anchor: middle !important; /* ✅ Centrage horizontal */
  dominant-baseline: central !important; /* ✅ Centrage vertical */
}

/* Labels dans foreignObject */
.mermaid-svg-container foreignObject {
  display: flex !important;
  align-items: center !important;
  justify-content: center !important;
  font-size: 18px !important; /* ✅ Augmenté pour lisibilité */
}

.mermaid-svg-container foreignObject > div,
.mermaid-svg-container foreignObject > span,
.mermaid-svg-container foreignObject p {
  display: flex !important;
  align-items: center !important;
  justify-content: center !important;
  text-align: center !important;
  width: 100% !important;
  height: 100% !important;
  font-family: var(--font-chat-text) !important; /* ✅ Cohérent avec chat */
  font-size: 18px !important; /* ✅ Augmenté pour lisibilité */
  line-height: 1.4 !important;
}

/* Style des liens/flèches */
.mermaid-svg-container .edgePath .path {
  stroke: var(--mermaid-theme-line-color) ;
}
.mermaid-svg-container .arrowheadPath {
  fill: var(--mermaid-theme-line-color) ;
}

/* Texte sur les liens */
.mermaid-svg-container .edgeLabel {
  background-color: var(--block-bg) ; /* Pour que le texte soit lisible sur la ligne */
  color: var(--mermaid-theme-text-color) ;
}
.mermaid-svg-container .edgeLabel rect {
  fill: var(--block-bg) ;
  opacity: 0.8;
}
.mermaid-svg-container .edgeLabel text {
  fill: var(--mermaid-theme-text-color) ;
}

/* Surcharge pour des types de diagrammes spécifiques si nécessaire */

/* Flowchart */
.mermaid-svg-container .flowchart-label {
  color: #ffffff !important;
  display: flex !important;
  align-items: center !important;
  justify-content: center !important;
  text-align: center !important;
}
.mermaid-svg-container .flowchart-link {
  stroke: var(--mermaid-theme-line-color) ;
}

/* Labels containers flowchart */
.mermaid-svg-container .label-container {
  display: flex !important;
  align-items: center !important;
  justify-content: center !important;
}

.mermaid-svg-container .label {
  display: flex !important;
  align-items: center !important;
  justify-content: center !important;
  text-align: center !important;
}

/* Rayons de bordure pour tous les rectangles de nœuds */
.mermaid-svg-container rect[id*="node"] {
  rx: 12px; /* ✅ Cohérent avec code blocks */
  ry: 12px;
  fill: rgba(255, 255, 255, 0.03) !important; /* ✅ Background glass subtil */
  backdrop-filter: blur(10px) !important; /* ✅ Effet blur */
  -webkit-backdrop-filter: blur(10px) !important; /* ✅ Safari */
}

/* Rayons de bordure pour les rectangles génériques dans les diagrammes */
.mermaid-svg-container rect {
  rx: 12px; /* ✅ Cohérent avec code blocks */
  ry: 12px;
  fill: rgba(255, 255, 255, 0.03) !important; /* ✅ Background glass subtil */
  backdrop-filter: blur(10px) !important; /* ✅ Effet blur */
  -webkit-backdrop-filter: blur(10px) !important; /* ✅ Safari */
}

/* Sequence Diagram */
.mermaid-svg-container .actor {
  stroke: var(--mermaid-theme-secondary-border-color) ;
  fill: rgba(255, 255, 255, 0.03) !important; /* ✅ Background glass subtil */
  backdrop-filter: blur(10px) !important; /* ✅ Effet blur */
  -webkit-backdrop-filter: blur(10px) !important; /* ✅ Safari */
  rx: 12px; /* ✅ Cohérent avec code blocks */
  ry: 12px;
}
.mermaid-svg-container .actor-label,
.mermaid-svg-container .messageText {
  fill: var(--mermaid-theme-text-color) ;
  text-anchor: middle !important;
  dominant-baseline: central !important;
}
.mermaid-svg-container .sequence-number {
  fill: var(--mermaid-theme-text-color) ;
}

/* Gantt Chart */
.mermaid-svg-container .section {
  fill: rgba(255, 255, 255, 0.03) !important; /* ✅ Background glass subtil */
  backdrop-filter: blur(10px) !important; /* ✅ Effet blur */
  -webkit-backdrop-filter: blur(10px) !important; /* ✅ Safari */
  stroke: var(--mermaid-theme-secondary-border-color) ;
  rx: 12px; /* ✅ Cohérent avec code blocks */
  ry: 12px;
}
.mermaid-svg-container .task {
  fill: rgba(255, 255, 255, 0.03) !important; /* ✅ Background glass subtil */
  backdrop-filter: blur(10px) !important; /* ✅ Effet blur */
  -webkit-backdrop-filter: blur(10px) !important; /* ✅ Safari */
  stroke: var(--mermaid-theme-primary-border-color) ;
  rx: 12px; /* ✅ Cohérent avec code blocks */
  ry: 12px;
}
.mermaid-svg-container .taskText {
  fill: var(--mermaid-theme-primary-text-color) ;
  text-anchor: middle !important;
  dominant-baseline: central !important;
}

/* Rayons de bordure pour les éléments de classe et d'état */
.mermaid-svg-container .classBox,
.mermaid-svg-container .stateBox,
.mermaid-svg-container .noteBox {
  rx: 12px; /* ✅ Cohérent avec code blocks */
  ry: 12px;
  fill: rgba(255, 255, 255, 0.03) !important; /* ✅ Background glass subtil */
  backdrop-filter: blur(10px) !important; /* ✅ Effet blur */
  -webkit-backdrop-filter: blur(10px) !important; /* ✅ Safari */
}

/* Rayons de bordure pour les éléments de diagramme d'état */
.mermaid-svg-container .state-node {
  rx: 12px; /* ✅ Cohérent avec code blocks */
  ry: 12px;
  fill: rgba(255, 255, 255, 0.03) !important; /* ✅ Background glass subtil */
  backdrop-filter: blur(10px) !important; /* ✅ Effet blur */
  -webkit-backdrop-filter: blur(10px) !important; /* ✅ Safari */
}

/* Rayons de bordure pour les éléments de diagramme de classe */
.mermaid-svg-container .class-node {
  rx: 12px; /* ✅ Cohérent avec code blocks */
  ry: 12px;
  fill: rgba(255, 255, 255, 0.03) !important; /* ✅ Background glass subtil */
  backdrop-filter: blur(10px) !important; /* ✅ Effet blur */
  -webkit-backdrop-filter: blur(10px) !important; /* ✅ Safari */
}

/* Cacher le texte d'erreur généré par Mermaid à l'intérieur du SVG */
.mermaid-svg-container svg text.error-text {
  display: none ;
}

/* ==========================================================================
   STYLES POUR LA MODALE MERMAID
   ========================================================================== */

/* ✅ Font globale pour la modale */
.mermaid-modal svg {
  font-family: var(--font-chat-text) !important; /* ✅ Cohérent avec chat */
  font-size: 18px !important; /* ✅ Augmenté pour lisibilité */
}

/* ✅ Centrage global du texte SVG + taille cohérente dans la modale */
.mermaid-modal svg text {
  text-anchor: middle !important;
  dominant-baseline: central !important;
  font-family: var(--font-chat-text) !important; /* ✅ Cohérent avec chat */
  font-size: 18px !important; /* ✅ Augmenté pour lisibilité */
  fill: #ffffff !important;
}

/* ✅ Labels dans foreignObject - modale */
.mermaid-modal foreignObject {
  display: flex !important;
  align-items: center !important;
  justify-content: center !important;
  font-size: 18px !important; /* ✅ Augmenté pour lisibilité */
}

.mermaid-modal foreignObject > div,
.mermaid-modal foreignObject > span,
.mermaid-modal foreignObject p {
  display: flex !important;
  align-items: center !important;
  justify-content: center !important;
  text-align: center !important;
  width: 100% !important;
  height: 100% !important;
  font-family: var(--font-chat-text) !important; /* ✅ Cohérent avec chat */
  font-size: 18px !important; /* ✅ Augmenté pour lisibilité */
  line-height: 1.4 !important;
}

/* Rayons de bordure pour tous les rectangles dans la modale Mermaid */
.mermaid-modal svg rect {
  rx: 12px; /* ✅ Cohérent avec code blocks */
  ry: 12px;
  fill: rgba(255, 255, 255, 0.03) !important; /* ✅ Background glass subtil */
  backdrop-filter: blur(10px) !important; /* ✅ Effet blur */
  -webkit-backdrop-filter: blur(10px) !important; /* ✅ Safari */
}

/* Rayons de bordure pour les rectangles de nœuds dans la modale */
.mermaid-modal svg rect[id*="node"] {
  rx: 12px; /* ✅ Cohérent avec code blocks */
  ry: 12px;
  fill: rgba(255, 255, 255, 0.03) !important; /* ✅ Background glass subtil */
  backdrop-filter: blur(10px) !important; /* ✅ Effet blur */
  -webkit-backdrop-filter: blur(10px) !important; /* ✅ Safari */
}

/* Rayons de bordure pour les éléments spécifiques dans la modale */
.mermaid-modal svg .actor {
  rx: 12px; /* ✅ Cohérent avec code blocks */
  ry: 12px;
  fill: rgba(255, 255, 255, 0.03) !important; /* ✅ Background glass subtil */
  backdrop-filter: blur(10px) !important; /* ✅ Effet blur */
  -webkit-backdrop-filter: blur(10px) !important; /* ✅ Safari */
}

.mermaid-modal svg .section,
.mermaid-modal svg .task {
  rx: 12px; /* ✅ Cohérent avec code blocks */
  ry: 12px;
  fill: rgba(255, 255, 255, 0.03) !important; /* ✅ Background glass subtil */
  backdrop-filter: blur(10px) !important; /* ✅ Effet blur */
  -webkit-backdrop-filter: blur(10px) !important; /* ✅ Safari */
}

.mermaid-modal svg .classBox,
.mermaid-modal svg .stateBox,
.mermaid-modal svg .noteBox {
  rx: 12px; /* ✅ Cohérent avec code blocks */
  ry: 12px;
  fill: rgba(255, 255, 255, 0.03) !important; /* ✅ Background glass subtil */
  backdrop-filter: blur(10px) !important; /* ✅ Effet blur */
  -webkit-backdrop-filter: blur(10px) !important; /* ✅ Safari */
}

/* ✅ Styles de texte spécifiques pour la modale */
.mermaid-modal .nodeLabel,
.mermaid-modal .flowchart-label,
.mermaid-modal .label {
  color: #ffffff !important;
  display: flex !important;
  align-items: center !important;
  justify-content: center !important;
  text-align: center !important;
}

.mermaid-modal .label-container {
  display: flex !important;
  align-items: center !important;
  justify-content: center !important;
}

.mermaid-modal .node text {
  fill: #ffffff !important;
}

.mermaid-modal .actor-label,
.mermaid-modal .messageText {
  fill: var(--mermaid-theme-text-color) ;
  text-anchor: middle !important;
  dominant-baseline: central !important;
}

.mermaid-modal .taskText {
  fill: var(--mermaid-theme-primary-text-color) ;
  text-anchor: middle !important;
  dominant-baseline: central !important;
}
